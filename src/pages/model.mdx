---
layout: '../layouts/markdown.astro'
title: 'Model'
Contributor: ["contributor11","contributor2"]
---
import { Image } from 'astro:assets';
import image1 from '../assets/Education/image/image1.png';
import image2 from '../assets/Education/image/image2.png';
import image3 from '../assets/Education/image/image3.png';
import image4 from '../assets/Education/image/image4.png';
import image5 from '../assets/Education/image/image5.png';
import image6 from '../assets/Education/image/image6.png';
import image7 from '../assets/Education/image/image7.png';


# Model

# Overview

Nattokinase (NK) produced by *Bacillus subtilis subsp. natto* (*B. subtilis natto*) is known to degrade fibrinogen in plasma. Based on this fact, a method called fibrinolysis assay is usually used to quantify NK [1]. This method is a technique in which a halo is formed by placing a culture medium containing NK on a fibrin sheet in a petri dish, and the NK activity can be visually confirmed by observing the size of the halo. 

However, the unit of FU is usually used to quantify NK activity, and to estimate FU from the visual size of the halo, it is necessary to conduct several experiments to obtain a reference curve. Moreover, this method is a statistical method, and it may be difficult to improve the curve when errors occur. 

Therefore, we developed a new mathematical model to estimate FU deterministically from the halo radius by fibrinolysis assay. This deterministic mathematical model is expected to provide explanatory power and facilitate the search for sources of error. Moreover, since our model can estimate FU at different concentrations once the biological parameters are determined, it is expected to minimize the experimenter's man-hours compared to the reference curve method.  

Next, our team used NB medium (Nutrients Broth medium), which contains a large amount of amino acids, for the culture of *B. subtilis natto*. Although metabolic pathway analysis has been conducted in media containing Glucose and Glycerol, metabolism under NB medium has not been analyzed [2]. Since NB medium generally does not contain sugar, it is possible that amino acids in NB medium are directly utilized for NK production without moving metabolic pathways such as the glycolytic system. 

Therefore, we used Flux Balance Analysis to clarify the metabolic pathway by which *B. subtilis natto* produces NK in the NB medium. This study will provide a concrete understanding of the culture of *B. subtilis natto* in the NB medium, which has not been understood so far, and will make it possible to arrange the optimal medium for NK production in future studies.

# Our approach

We implemented two main types of modeling to better understand Nattokinase (NK) quantification and production.

The first model focuses on predicting NK concentration based on the fibrin degradation radius observed in the halo assay, a common method for NK quantification. This approach uses partial differential equations to perform an inverse prediction, as described in the FU Prediction section.

The second model analyzes the metabolic pathways through which *B. subtilis natto* produces NK in NB medium. For this, we conducted a simulation using Flux Balance Analysis (FBA), detailed in the *Metabolism Analysis* section.

# FU Prediction (Reaction-Porous Medium Equation Model)

## Materials and Methods

First, we derived a partial differential equation for the relationship between NK and fibrin with two-dimensional space and time as variables by making the following assumptions and definitions based on previous studies [3, 4]. Next, we estimated the parameters included in the partial differential equation based on experiments.

## Derivation of equations

**Definition 1．**  
\begin{gather}  
\mathcal{E} = \mathcal{E}(x, y, t) \\  
u = u(x, y, t) \\  
v = v(x, y, t)  
\end{gather}  
where $\mathcal{E}$ is the concentration of NK at a spatial point in the petri dish, $u$ is the concentration of the fibrin-NK action site before degradation, and $v$ is the concentration of the fibrin-NK action site after degradation. The degradation is assumed to be an irreversible reaction.

**Assumption 1．**  
$u(x, y, 0) = \text{const.}$ that is, we assume that the time-initial value space of $u$ is uniform.

**Assumption 2.**  
The action sites of NK on fibrin are as shown in the figure [Fig. 1], ...-[node]-[action site]-[node]-[action site]-[action site]-[node]-[action site]-.... [3]; i.e., assuming that the action site exists as a “point” on the fibrin fiber, it is possible to reduce the discussion to a reaction kinetics discussion by focusing only on the action site. In other words, the law of mass action can be used.  
![][image1]  
Figure 1: Shows the action site of fibrin and NK, which are thought to be in a chain structure.

**Assumption 3．**  
The $\mathcal{E}$ spreads in space by natural diffusion. The total amount of $\mathcal{E}$ in the petri dish is always constant because NK is not decomposed in the petri dish.

**Assumption 4.**  
Fibrin shall retain its performance as a porous medium because of its fibrous form [4].

First, let's look at the diffusion term. Diffusion usually has the property of infinite propagation and is quickly distributed in space. However, since infinite propagation in a petri dish is unlikely, the diffusion term is described as diffusion in a porous medium using Assumption 4, rather than ordinary diffusion, to give it finite propagation.  

The following is a system of partial differential equations, where the reaction term is denoted by $g(x, y, t, u, v)$:
\begin{gather}  
\frac{\partial \mathcal{E}}{\partial t} = \nabla \cdot (D(\mathcal{E}) \nabla \mathcal{E}) \\  
\frac{\partial v}{\partial t} = \nabla \cdot (D(v) \nabla v) + g(x, y, t, u, v)  
\end{gather}
Here, $D(f)$ represents the diffusion coefficient, which depends on the function $f$, and is given by $D(f) = mf^{m-1}$, where $m > 1$ is a constant, as seen in the porous medium equation.

Next, we derive the reaction term based on the Michaelis-Menten equation, where the reaction mechanism is as follows:
\begin{gather}  
\mathcal{E} + u \overset{k_{+1}}{\underset{k_{-1}}{\rightleftharpoons}} \mathcal{E} u \overset{k_{+2}}{\rightarrow} \mathcal{E} + v  
\end{gather}

To isolate the reaction term, we consider an ordinary differential equation (ODE) involving only the time derivative. We focus on the concentrations of the complex $[\mathcal{E} u]$ (between $\mathcal{E}$ and $u$) and the product $v$:
\begin{gather}  
\frac{d[\mathcal{E} u]}{dt} = k_{+1} \mathcal{E}u - (k_{-1} + k_{+2})[\mathcal{E} u] \\  
\frac{dv}{dt} = k_{+2} [\mathcal{E} u]  
\end{gather}

Assuming that $[\mathcal{E} u]$ reaches a steady state, i.e., $d\mathcal[{E} u]/{dt} = 0$, we can substitute this into the second equation to obtain:
\begin{gather}  
\frac{dv}{dt} = V_{\text{max}} \frac{u}{K_M + u}  
\end{gather}

where $V_{\text{max}} = k_{+2} \mathcal{E}_T$ and $K_M = \frac{k_{-1} + k_{+2}}{k_{+1}}$.

Finally, the following system of partial differential equations is derived from the above considerations:
\begin{gather}  
\frac{\partial \mathcal{E}}{\partial t} = \nabla \cdot (D(\mathcal{E}) \nabla \mathcal{E}) \\  
\frac{\partial v}{\partial t} = \nabla \cdot (D(v) \nabla v) + V_{\text{max}} \frac{u}{K_M + u}  
\end{gather}


## Parameter estimation

We developed a mathematical model to describe the degradation radius observed in the halo assay as a function of NK concentration. By fitting this model to experimental data, we estimated the parameters $m$, $V_\text{max}$, and $K_M$, which are crucial for understanding the diffusion and reaction kinetics of NK in the fibrin gel. We used Python to calculate and visualize our model numerically.

### Data Preparation

We started by converting the observed diameters from the halo assay into radii and storing the corresponding FU values. Since we did not have experimental data available, we referenced data from literature values[8].  
```python  
# Experimental data: FU and corresponding diameter (in cm)  
FU_data = np.array([0, 2, 5, 10, 25, 50])  
diameter_data = np.array([0, 0.55, 0.60, 0.70, 0.89, 1.21])

# Convert diameter to radius (in cm)  
radius_data = diameter_data / 2  ... （残り240 KB）